{"version":3,"sources":["../../../../../src/javascripts/ng-admin/Crud/misc/EntryFormatter.js"],"names":["EntryFormatter","$filter","formatDate","format","date","formatNumber","number","field","label","name","type","entry","value","values","getTemplateValue","listValues","join","fields","fieldsFormatters","map","formatField","bind","formatEntry","result","formatter","forEach","$inject"],"mappings":"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","file":"EntryFormatter.js","sourcesContent":["export default class EntryFormatter {\n    constructor($filter) {\n        this.formatDate = function (format) {\n            return function (date) {\n                return $filter('date')(date, format);\n            };\n        };\n        this.formatNumber = function (format) {\n            return function (number) {\n                return $filter('numeraljs')(number, format);\n            };\n        };\n    }\n\n    formatField(field) {\n        var label = field.label() || field.name();\n        var type = field.type();\n        switch (type) {\n            case 'boolean':\n            case 'choice':\n            case 'choices':\n            case 'string':\n            case 'text':\n            case 'wysiwyg':\n            case 'email':\n            case 'json':\n            case 'file':\n                return function (entry) {\n                    return {\n                        name: label,\n                        value: entry.values[field.name()]\n                    };\n                };\n            case 'template':\n                return function (entry) {\n                    return {\n                        name: label,\n                        value: field.getTemplateValue(entry)\n                    };\n                };\n            case 'number':\n            case 'float':\n                var formatNumber = this.formatNumber(field.format());\n                return function (entry) {\n                    return {\n                        name: label,\n                        value: formatNumber(entry.values[field.name()])\n                    };\n                };\n            case 'date':\n            case 'datetime':\n                var format = field.format();\n                if (!format) {\n                    format = type === 'date' ? 'yyyy-MM-dd' : 'yyyy-MM-dd HH:mm:ss';\n                }\n\n                var formatDate = this.formatDate(format);\n                return function (entry) {\n                    return {\n                        name: label,\n                        value: formatDate(entry.values[field.name()])\n                    };\n                };\n            case 'reference':\n                return function (entry) {\n                    return {\n                        name: label,\n                        value: entry.listValues[field.name()]\n                    };\n                };\n            case 'reference_many':\n                return function (entry) {\n                    return {\n                        name: label,\n                        value: entry.listValues[field.name()].join(', ')\n                    };\n                };\n            case 'referenced_list':\n                return; //ignored\n        }\n    }\n\n    getFormatter(fields) {\n        var fieldsFormatters = fields.map(this.formatField.bind(this));\n\n        return function formatEntry(entry) {\n            var result = {};\n            fieldsFormatters.map(function (formatter) {\n                if (!formatter) {\n                    return;\n                }\n                return formatter(entry);\n            })\n            .forEach(function (field) {\n                if (!field) {\n                    return;\n                }\n                result[field.name] = field.value;\n            });\n\n            return result;\n        };\n    }\n}\n\nEntryFormatter.$inject = ['$filter'];\n"]}