{"version":3,"sources":["../../../../../../src/javascripts/test/unit/Crud/list/maDatagridPaginationSpec.js"],"names":["require","describe","directive","$compile","scope","directiveUsage","angular","module","config","$translateProvider","translations","preferredLanguage","beforeEach","mock","inject","_$compile_","_$rootScope_","it","totalItems","element","$digest","totalElement","querySelector","expect","innerText","trim","toBe","itemsPerPage","checkTotalText","page","expectedText","checkPrevLink","expected","firstButton","lastButton","querySelectorAll","buttons","length","checkPageLinks","Array","prototype","slice","call","buttonsText","map","button","toEqual"],"mappings":"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","file":"maDatagridPaginationSpec.js","sourcesContent":["require('angular-translate');\n\n/*global angular,inject,describe,it,expect,beforeEach,module*/\ndescribe('directive: ma-datagrid-pagination', function () {\n    var directive = require('../../../../ng-admin/Crud/list/maDatagridPagination'),\n        $compile,\n        scope,\n        directiveUsage = '<ma-datagrid-pagination page=\"{{ page }}\" total-items=\"{{ totalItems }}\" per-page=\"{{ itemsPerPage }}\"></ma-datagrid-pagination>';\n\n    angular.module('testapp_DatagridPagination', ['pascalprecht.translate'])\n        .directive('maDatagridPagination', directive)\n        .config(['$translateProvider', function($translateProvider) {\n            $translateProvider.translations('en', {\n              'PAGINATION': '<strong>{{ begin }}</strong> - <strong>{{ end }}</strong> of <strong>{{ total }}</strong>',\n            });\n            $translateProvider.preferredLanguage('en');\n        }]);\n\n    beforeEach(angular.mock.module('testapp_DatagridPagination'));\n\n    beforeEach(inject(function (_$compile_, _$rootScope_) {\n        $compile = _$compile_;\n        scope = _$rootScope_;\n    }));\n\n    describe('total display', function() {\n        it('should just display that no records have been found if no item fetched', function() {\n            scope.totalItems = 0;\n            var element = $compile(directiveUsage)(scope)[0];\n            scope.$digest();\n\n            var totalElement = element.querySelector('.pagination-bar .total');\n            expect(totalElement.innerText.trim()).toBe('NO_PAGINATION');\n        });\n\n        it('should display the current data range', function() {\n            scope.totalItems = 37;\n            scope.itemsPerPage = 10;\n\n            function checkTotalText(page, expectedText) {\n                scope.page = page;\n                var element = $compile(directiveUsage)(scope)[0];\n                scope.$digest();\n\n                var totalElement = element.querySelector('.pagination-bar .total');\n                expect(totalElement.innerText.trim()).toBe(expectedText);\n            }\n\n            checkTotalText(-1, '1 - 10 of 37');     // Lower pages should be considered as page 1\n            checkTotalText( 0, '1 - 10 of 37');\n            checkTotalText( 1, '1 - 10 of 37');\n            checkTotalText( 2, '11 - 20 of 37');\n            checkTotalText( 3, '21 - 30 of 37');\n            checkTotalText( 4, '31 - 37 of 37');\n            checkTotalText( 8, '31 - 37 of 37');    // Higher pages should be considered as last page\n        });\n    });\n\n    it('should display prev link except on the first one', function() {\n            scope.totalItems = 37;\n            scope.itemsPerPage = 10;\n            function checkPrevLink(page, expected) {\n                scope.page = page;\n                var element = $compile(directiveUsage)(scope)[0];\n                scope.$digest();\n                var firstButton = element.querySelector('.pagination-bar .pagination li');\n                expect(firstButton.innerText.trim()).toBe(expected);\n            }\n            checkPrevLink(1, '');\n            checkPrevLink(2, 'PREVIOUS');\n            checkPrevLink(3, 'PREVIOUS');\n            checkPrevLink(4, 'PREVIOUS');\n    });\n\n    it('should display next link except on the last one', function() {\n            scope.totalItems = 37;\n            scope.itemsPerPage = 10;\n            function checkPrevLink(page, expected) {\n                scope.page = page;\n                var element = $compile(directiveUsage)(scope)[0];\n                scope.$digest();\n                var lastButton = element.querySelectorAll('.pagination-bar .pagination li')[5];\n                expect(lastButton.innerText.trim()).toBe(expected);\n            }\n            checkPrevLink(1, 'NEXT');\n            checkPrevLink(2, 'NEXT');\n            checkPrevLink(3, 'NEXT');\n            checkPrevLink(4, '');\n    });\n\n    it('should not display pagination links if all items can be displayed on current page', function() {\n            scope.totalItems = 10;\n            scope.itemsPerPage = 11;\n            scope.page = 1;\n            var element = $compile(directiveUsage)(scope)[0];\n            scope.$digest();\n            var buttons = element.querySelectorAll('.pagination-bar .pagination li');\n            expect(buttons.length).toBe(0);\n    });\n\n    it('should display all links if number of pages is below 5', function() {\n            scope.totalItems = 37;\n            scope.itemsPerPage = 10;\n            scope.page = 1;\n            var element = $compile(directiveUsage)(scope)[0];\n            scope.$digest();\n            var buttons = element.querySelectorAll('.pagination-bar .pagination li');\n            expect(buttons[1].innerText.trim()).toBe('1');\n            expect(buttons[2].innerText.trim()).toBe('2');\n            expect(buttons[3].innerText.trim()).toBe('3');\n            expect(buttons[4].innerText.trim()).toBe('4');\n    });\n\n    it('should display truncated centered page range if number of pages is above 5', function() {\n            scope.totalItems = 87;\n            scope.itemsPerPage = 10;\n            function checkPageLinks(page, expected) {\n                scope.page = page;\n                var element = $compile(directiveUsage)(scope)[0];\n                scope.$digest();\n                var buttons = Array.prototype.slice.call(element.querySelectorAll('.pagination-bar .pagination li'));\n                var buttonsText = buttons.map(function(button) { return button.innerText.trim(); });\n                expect(buttonsText).toEqual(expected);\n            }\n            checkPageLinks(1, ['', '1', '2', '…', '9', 'NEXT']);\n            checkPageLinks(2, ['PREVIOUS', '1', '2', '3', '…', '9', 'NEXT']);\n            checkPageLinks(3, ['PREVIOUS', '1', '2', '3', '4', '…', '9', 'NEXT']);\n            checkPageLinks(4, ['PREVIOUS', '1', '2', '3', '4', '5', '…', '9', 'NEXT']);\n            checkPageLinks(5, ['PREVIOUS', '1', '…', '4', '5', '6', '…', '9', 'NEXT']);\n            checkPageLinks(6, ['PREVIOUS', '1', '…', '5', '6', '7', '8', '9', 'NEXT']);\n            checkPageLinks(7, ['PREVIOUS', '1', '…', '6', '7', '8', '9', 'NEXT']);\n            checkPageLinks(8, ['PREVIOUS', '1', '…', '7', '8', '9', 'NEXT']);\n            checkPageLinks(9, ['PREVIOUS', '1', '…', '8', '9', '']);\n    });\n});\n"]}