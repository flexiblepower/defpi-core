{"version":3,"sources":["../../../../src/javascripts/test/e2e/ListViewSpec.js"],"names":["describe","beforeEach","browser","get","baseUrl","it","$","click","getLocationAbsUrl","then","url","expect","toContain","listUrl","encodeURI","executeScript","$$","elements","getText","toBe","getCurrentUrl","selectItemAndGoToBatchDelete","length","toMatch","numComments","xit","first","element","rows","getAttribute","title"],"mappings":"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","file":"ListViewSpec.js","sourcesContent":["/*global describe,it,expect,$,$$,element,browser,by*/\ndescribe('ListView', function () {\n    'use strict';\n\n    beforeEach(function () {\n        browser.get(browser.baseUrl + '#/posts/list');\n    });\n\n    describe('Edition link', function () {\n        it('should allow edition of an entity', function () {\n            // Retrieve first edit button\n            $('table tr:nth-child(1) ma-edit-button a').click();\n\n            // Check browser URL\n            browser.getLocationAbsUrl().then(function(url) {\n                expect(url).toContain('/posts/edit/');\n            });\n        });\n    });\n\n    describe('Show link', function () {\n        it('should allow display of an entity', function () {\n            // Retrieve first edit button\n            $('table tr:nth-child(1) ma-show-button a').click();\n\n            // Check browser URL\n            browser.getLocationAbsUrl().then(function(url) {\n                expect(url).toContain('/posts/show/');\n            });\n        });\n    });\n\n    describe('ma-list-button', function () {\n        var listUrl;\n\n        beforeEach(function() {\n            listUrl = encodeURI(browser.baseUrl + '/#/comments/list?search={\"post_id\":\"9\"}');\n            browser.get(listUrl);\n        });\n\n        it('should restore the list with filter when used from edit', function () {\n            browser.executeScript('window.scrollTo(810, 481)').then(function () {\n                return $$('ma-edit-button a');\n            }).then(function (elements) {\n                expect(elements[0].getText()).toBe(' Edit');\n                return elements[0].click();\n            }).then(function() {\n                expect(browser.getCurrentUrl()).toBe(browser.baseUrl + '/#/comments/edit/2');\n                return $$('ma-list-button a');\n            }).then(function (elements) {\n                return elements[0].click();\n            }).then(function() {\n                expect(browser.getCurrentUrl()).toBe(listUrl);\n            });\n        });\n\n        it('should restore the list with filter after delete confirmation', function () {\n            browser.executeScript('window.scrollTo(810, 481)').then(function () {\n                return $$('ma-delete-button a');\n            }).then(function (elements) {\n                expect(elements[0].getText()).toBe(' Delete');\n                return elements[0].click();\n            }).then(function() {\n                expect(browser.getCurrentUrl()).toBe(browser.baseUrl + '/#/comments/delete/2');\n                return $$('button.btn-danger');\n            }).then(function (elements) {\n                return elements[0].click();\n            }).then(function() {\n                expect(browser.getCurrentUrl()).toBe(listUrl);\n            });\n        });\n\n        it('should restore the list with filter after delete cancel', function () {\n            browser.executeScript('window.scrollTo(810, 481)').then(function () {\n                return $$('ma-delete-button a');\n            }).then(function (elements) {\n                expect(elements[0].getText()).toBe(' Delete');\n                return elements[0].click();\n            }).then(function() {\n                expect(browser.getCurrentUrl()).toBe(browser.baseUrl + '/#/comments/delete/2');\n                return $$('button.btn-default');\n            }).then(function (elements) {\n                return elements[0].click();\n            }).then(function() {\n                expect(browser.getCurrentUrl()).toBe(listUrl);\n            });\n        });\n    });\n\n    function selectItemAndGoToBatchDelete() {\n        return $$('ma-view-batch-actions button')\n        .then(function (elements) {\n            expect(elements.length).toBe(0);\n            return $$('ma-datagrid-item-selector');\n        })\n        .then(function (elements) {\n            // expect(elements.length).toBe(numComments);\n            elements[0].click();\n\n            return $$('ma-view-batch-actions button');\n        })\n        .then(function (elements) {\n            expect(elements.length).toBe(1);\n            elements[0].click();\n            return $$('ma-batch-delete-button');\n        })\n        .then(function (elements) {\n            expect(elements.length).toBe(1);\n            elements[0].click();\n            expect(browser.getCurrentUrl()).toMatch(browser.baseUrl + '/#/comments/batch-delete/');\n\n            return $$('#page-wrapper button');\n        });\n    }\n\n    describe('ma-batch-delete-button', function () {\n        it('should show the batch delete button only when at least one line is selected', function () {\n            browser.get('/#/comments/list');\n            var numComments;\n            $$('tbody tr').then(function (elements) {\n                numComments = elements.length;\n                return selectItemAndGoToBatchDelete();\n            })\n            .then(function (elements) {\n                expect(elements[1].getText()).toBe('No');\n                elements[1].click();\n                expect(browser.getCurrentUrl()).toMatch(browser.baseUrl + '/#/comments/list');\n                return $$('tbody tr');\n            })\n            .then(function (elements) {\n                expect(elements.length).toBe(numComments);\n            });\n        });\n\n        // @TODO allow to delete item without broking other test\n        xit('should show the batch delete button only when at least one line is selected', function () {\n            browser.get('/#/comments/list');\n            var numComments;\n            $$('tbody tr').then(function (elements) {\n                numComments = elements.length;\n                return selectItemAndGoToBatchDelete();\n            })\n            .then(function (elements) {\n                expect(elements[0].getText()).toBe('Yes');\n                elements[0].click();\n                expect(browser.getCurrentUrl()).toMatch(browser.baseUrl + '/#/comments/list');\n                return $$('tbody tr');\n            })\n            .then(function (elements) {\n                expect(elements.length).toBe(numComments - 1);\n            });\n        });\n    });\n\n    describe('prepare', function() {\n        it('should execute after the resolve and before the controller', function() {\n            browser.get('/#/tags/list')\n                .then(function() {\n                    return $$('td.ng-admin-column-nb_posts').first();\n                })\n                .then(function(element) {\n                    expect(element.getText()).toBe('2');\n                });\n        });\n    });\n\n    describe('entryCssClasses', function() {\n        it('set the class to the entire row according to the entry', function() {\n            $$('tbody tr')\n            .then(function(rows) {\n                expect(rows[0].getAttribute('class')).toBe('ng-scope is-popular');\n                expect(rows[1].getAttribute('class')).toBe('ng-scope');\n            });\n        });\n    });\n\n    describe('translate', () => {\n        it('should not escape HTML characters', () => {\n            const title = $$('tbody tr:last-child .ng-admin-column-title').first();\n\n            // If this title is escaped, it will be:\n            // Accusantium qui nihil &amp; voluptatum quia voluptas maxime ab similique\n            expect(title.getText()).toBe('Accusantium qui nihil & voluptatum quia voluptas maxime ab similique');\n        });\n    });\n});\n"]}